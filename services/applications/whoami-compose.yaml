services:
  whoami:
    extends:
      file: common.yaml
      service: application
    image: traefik/whoami
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.whoami.rule=Host(`${HOST}.${DOMAIN}`)&&PathRegexp(`^/whoami/?`)"
      - "traefik.http.routers.whoami.entrypoints=websecure"
      - "traefik.http.services.whoami.loadbalancer.server.port=80"
      # Apply middlewares
      - "traefik.http.routers.whoami.middlewares=compress-traefik@file,oauth-auth,oauth-errors,security-headers@file"
      # Enable TLS on this router
      - "traefik.http.routers.whoami.tls=true"
#      # Use Let's Encrypt for TLS management
#      - "traefik.http.routers.whoami.tls.certresolver=letsencrypt"
